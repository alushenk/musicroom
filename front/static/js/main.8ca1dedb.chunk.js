(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{245:function(e,t,a){e.exports=a(517)},419:function(e,t,a){},427:function(e,t,a){},429:function(e,t,a){},467:function(e,t,a){},480:function(e,t,a){},482:function(e,t,a){},489:function(e,t,a){},509:function(e,t,a){},513:function(e,t,a){},515:function(e,t,a){},517:function(e,t,a){"use strict";a.r(t);var r,n,i,c,s,o=a(0),l=a.n(o),u=a(8),d=a.n(u),p=a(23),m=a(31),h=a(33),f=a(32),b=a(34),y=a(58),v=a(460),g=a(527),w=a(13),k=a(24),O=a(7),j=a(159),E=a(41),S=a(9),P=a.n(S),x=a(36),L=a(526),N=a(520),T=a(82),F=a(119),C=a.n(F),I=a(27),D=a.n(I),M=a(49),z=a(518),A=a(521),R=(a(419),a(14)),U=a(59),B="https://fallback.png",V="wss://musicroom.ml/ws",_={refresh:"refresh",delete:"delete"},H="Track already exists",q={userName:"username",password:"password",repeatPassword:"repeatPassword",email:"email",formActionType:"formActionType"},W={login:"login",register:"register"},Y="pending",Z="done",K={token:"mr-api-token",userId:"mr-user-id"},G=function(){var e=Number(localStorage.getItem(K.userId));return isFinite(e)&&!isNaN(e)&&e>0?e:null},J=("abcdefghijklmnopqrstuvwxyz".toUpperCase().split(""),function(e){return e*Math.PI/180}),Q=function(e,t){var a=J(Math.abs(t.lat-e.lat)),r=J(Math.abs(t.lon-e.lon)),n=J(e.lat),i=J(t.lat),c=Math.sin(a/2)*Math.sin(a/2)+Math.sin(r/2)*Math.sin(r/2)*Math.cos(n)*Math.cos(i);return 6371*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))},$=function(e,t){return e&&t?e.radius!==t.radius||(Math.floor(1e4*e.lat)!==Math.floor(1e4*t.lat)||Math.floor(1e4*e.lon)!==Math.floor(1e4*t.lon)):!(!e&&!t)},X=function(e,t){var a=D()(t.response,"data");if(a){var r=Object.entries(a).reduce(function(t,a){var r=Object(M.a)(a,2),n=r[0],i=r[1],c=e.getFieldValue(n);if(!c)return t;var s="Field has errors.";return i instanceof String?s=i:Array.isArray(i)&&(s=i.join(" ")),Object(U.a)({},t,Object(R.a)({},n,{value:c,errors:[{message:s}]}))},{});e.setFields(r)}},ee=function(e){var t=D()(e.response,"data")||{};console.log(t);var a=D()(t,"non_field_errors")||"Something went wrong, please try again later.",r=a;Array.isArray(a)&&(r=a.join(" ")),L.a.error(r)},te=function(e){var t=[D()(e,["response","status"]),D()(e,["response","data"])||{}];return 403===t[0]&&"You do not have permission to perform this action."===t[1].detail&&(L.a.info("You have no access to this content."),!0)},ae=function(){},re=function(){return localStorage.getItem(K.token)&&G()},ne=function(e){var t=e.trackIds,a=void 0===t?[]:t,r=e.startTrackIndex,n=void 0===r?0:r,i=e.className,c=void 0===i?"":i,s=e.onClickSideEffect,o=void 0===s?ae:s;return l.a.createElement(w.a,{type:"play-circle",className:"action-icon ".concat(c),onClick:function(){!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;void 0!==window.DZ&&window.DZ.player?window.DZ.player.playTracks(e,t,function(e){}):console.warn("Deezer player is not present on current page. Sorry for inconvenience.")}(a,n),o()}})},ie=(a(427),function(e){return l.a.createElement(w.a,{type:e.iconType,onClick:e.onClick,className:"action-icon"})}),ce=(a(429),[{title:"Artist",dataIndex:"artist",key:"artist",width:"15%",render:function(e,t){return D()(t.data,["artist","name"],"no-artist")}},{title:"Album",dataIndex:"album",key:"album",width:"15%`",render:function(e,t){return D()(t.data,["album","title"],"no-album")}},{title:"Album Cover",dataIndex:"albumCover",key:"albumCover",width:"15%`",render:function(e,t){return l.a.createElement("img",{alt:"album-cover",className:"album-cover-small",src:D()(t.data,["album","cover"],B)})}}]),se={hideOnSinglePage:!0,showSizeChanger:!0},oe=function(e){var t=Object(o.useState)(null),a=Object(M.a)(t,2),r=a[0],n=a[1],i=e.playlistId,c=e.playlistsStore,s=void 0===c?{}:c,u=e.items,d=e.withSelectableRows,p=e.selectedItem,m=e.handleItemSelect,h=e.configureActionColumn,f=e.showRatingColumn,b=e.onPlaySideEffect,y=void 0===b?ae:b,v=u.map(function(e){return e.data.id}),g=[{title:"Title",dataIndex:"title",key:"title",width:"15%",render:function(e,t,a){return l.a.createElement("div",{className:"track-record-title"},D()(t.data,"title","no-title"),l.a.createElement("div",{className:"title-play-button"},l.a.createElement(ne,{onClickSideEffect:y,trackIds:v,startTrackIndex:a})))}}].concat(ce);f&&g.push({title:"Rating",dataIndex:"rating",key:"rating",className:"ant-rating-column",width:"15%",render:function(e,t){var a=D()(t,"votes",[]),r=G();if(!r)return null;var n=a.find(function(e){var t=e.user;return Number(t)===r})?{iconType:"dislike",onClick:function(){return s.voteTrack(t.id,i,!0)}}:{iconType:"like",onClick:function(){return s.voteTrack(t.id,i)}};return l.a.createElement("div",{className:"track-record-rating"},l.a.createElement("span",{className:"track-rating-likes"},a.length),l.a.createElement(ie,n))}});var k=Object(E.a)(g).concat([h?h(r,n):{title:"Action",key:"action",width:"15%`",render:function(e){var t=e.id;return l.a.createElement(z.a,{content:l.a.createElement("div",null,l.a.createElement("p",null,"Select playlist"),l.a.createElement(T.a,{type:"primary",onClick:function(){return console.log("Add to selected playlist")}},"Add")),arrowPointAtCenter:!0,title:"Title",trigger:"click",visible:t===r,onVisibleChange:function(e){return n(e?t:null)}},l.a.createElement(w.a,{type:"plus-circle",className:"action-icon"}))}}]),O=d?{onRow:function(e){return{onClick:function(){return m(e.id)}}}}:{};return l.a.createElement(A.a,Object.assign({rowKey:function(e){return"track-item-".concat(e.id)},columns:k,dataSource:u,rowClassName:function(e){return d&&e.id===p?"track-record active":"track-record"}},O,{pagination:se}))},le=a(524),ue=(a(467),function(e){var t=Object(o.useState)(""),a=Object(M.a)(t,2),r=a[0],n=a[1],i=e.renderItems,c=e.searchIsLoading,s=e.handleSearch;return l.a.createElement("div",{className:"dz-search-container"},l.a.createElement("div",{className:"dz-search-bar"},l.a.createElement(le.a,{onChange:function(e){n(e.target.value)},value:r}),l.a.createElement(T.a,{loading:c,disabled:c,onClick:function(){var e=function(){if(!r)return null;var e={},t=r.split("&&").map(function(e){return e.trim()}),a=!0,n=!1,i=void 0;try{for(var c,s=t[Symbol.iterator]();!(a=(c=s.next()).done);a=!0){var o=c.value.split(":").map(function(e){return e.trim().toLowerCase()});if(1===o.length){var l=Object(M.a)(o,1)[0];Object.assign(e,{track:l})}if(2===o.length){var u=Object(M.a)(o,2),d=u[0],p=u[1];Object.assign(e,Object(R.a)({},d,p))}}}catch(m){n=!0,i=m}finally{try{a||null==s.return||s.return()}finally{if(n)throw i}}return e}();e&&s(e)}},"Fetch")),i())}),de=a(525),pe=a(522),me=a(523),he=a(18),fe=a.n(he),be=a(519),ye=pe.a.Item,ve=function(e){var t=e.label,a=e.fieldName,r=e.form,n=r.getFieldDecorator,i=r.getFieldValue,c=r.setFieldsValue;return n(a),l.a.createElement(ye,{label:t},l.a.createElement(be.a,{checked:i(a),onClick:function(e){return c(Object(R.a)({},a,e))}}))},ge=a(227),we=ge.a.Option,ke=pe.a.Item,Oe=function(e){var t=e.form,a=t.getFieldValue,r=t.getFieldDecorator,n=e.users,i=e.formFieldName,c=e.label,s=e.onSelectHandler,o=void 0===s?function(){return Promise.resolve()}:s,u=e.onDeselectHandler,d=void 0===u?function(){return Promise.resolve()}:u;return r(i),l.a.createElement("div",{id:"form-field-".concat(i)},l.a.createElement(ke,{label:c},l.a.createElement(ge.a,{value:a(i),showSearch:!0,optionFilterProp:"search-value",mode:"multiple",notFoundContent:"No users found...",placeholder:"Select users...",onSelect:function(e){o(Number(e))},onDeselect:function(e){d(Number(e))},getPopupContainer:function(){return document.getElementById("form-field-".concat(i))}},n.map(function(e){return l.a.createElement(we,{key:e.id,"search-value":e.username,title:function(e){var t=e.first_name,a=e.second_name,r=t||a;return t||a?t&&a&&(r="".concat(t," ").concat(a)):r="Name is not specified",r}(e),value:e.id},e.username)}))))},je="play-list-data-form",Ee={name:"name",isPublic:"is_public",participants:"participants",owners:"owners",hasTimeRestriction:"hasTimeRestriction",timeFrom:"time_from",timeTo:"time_to",hasLocationRestriction:"hasLocationRestriction",location:"location",locationRadius:"radius"},Se={lat:50.4507,lng:30.523},Pe=function(e){function t(){var e,a;Object(p.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(n)))).state={tracks:[],address:"Maidan Nezalezhnosti, 2, Kyiv, Ukraine, 02000",position:Object(U.a)({},Se)},a.fieldsToValidate=[Ee.name,Ee.locationRadius],a.componentDidMount=function(){a.props.settingsStore.getUsers(),a.setState({position:a.getDefaultLocation()})},a.handleLocationChange=function(e){var t=e.position,r=e.address;a.setState({position:t,address:r})},a.addTrackToList=function(e){a.state.tracks.find(function(t){return t.id===e.id})?L.a.warning("Tracks duplicates are forbidden."):a.setState(function(t){return{tracks:Object(E.a)(t.tracks).concat([e])}})},a.removeTrackFromListById=function(e){a.setState(function(t){return{tracks:t.tracks.filter(function(t){return t.id!==e})}})},a.normalizeFormValues=function(e){var t=a.state,r=t.tracks,n=t.position,i=a.props.isCreateForm,c=Object(U.a)({name:e[Ee.name],is_public:e[Ee.isPublic],place:e[Ee.hasLocationRestriction]?{lat:Number(n.lat),lon:Number(n.lng),radius:Number(e[Ee.locationRadius])}:null},e[Ee.hasTimeRestriction]?{time_from:e[Ee.timeFrom],time_to:e[Ee.timeTo]}:{time_from:null,time_to:null});return i?(Object.assign(c,{tracks:r.map(function(e){return e.data})}),c):c},a.handleOk=function(){var e=a.props,t=e.form,r=e.handleSubmit;t.validateFields(a.fieldsToValidate,function(e){if(!e){var n=a.normalizeFormValues(t.getFieldsValue());r(n)}})},a.userSelectOnSelect=function(e){return function(t){var r=a.props,n=r.isCreateForm,i=r.playlistsStore,c=r.playListItem;if(!n){if("participant"===e)return i.playlistParticipant(c.id,t,"add");if("owner"===e)return i.playlistOwner(c.id,t,"add")}return Promise.resolve()}},a.userSelectOnDeselect=function(e){return function(t){var r=a.props,n=r.isCreateForm,i=r.playlistsStore,c=r.playListItem;if(!n){if("participant"===e)return i.playlistParticipant(c.id,t,"remove");if("owner"===e)return i.playlistOwner(c.id,t,"remove")}return Promise.resolve()}},a.getDefaultLocation=function(){var e=a.props.playListItem;return{lat:D()(e,["place","lat"])||Se.lat,lng:D()(e,["place","lon"])||Se.lng}},a.getDefaultDateProp=function(e){var t=a.props.playListItem,r={},n=D()(t,e,void 0);return n&&Object.assign(r,{defaultValue:fe()(n)}),r},a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state.tracks,a=this.props,r=a.form,n=a.tracksStore,i=a.settingsStore,c=a.isCreateForm,s=r.getFieldValue(Ee.hasTimeRestriction),u=r.getFieldValue(Ee.hasLocationRestriction);this.fieldsToValidate=u?[Ee.name,Ee.locationRadius]:[Ee.name],r.getFieldDecorator(Ee.timeFrom),r.getFieldDecorator(Ee.timeTo);var d=Object(O.q)(i.allUsers);return r.getFieldDecorator(Ee.participants),l.a.createElement(pe.a,{id:je},l.a.createElement(pe.a.Item,{label:"Playlist name:"},r.getFieldDecorator(Ee.name,{validateFirst:!0,rules:[{required:!0,message:"Name is required."},{max:255,message:"Maximum length is 255 symbols."}]})(l.a.createElement(le.a,{placeholder:"Name your playlist..."}))),!c&&l.a.createElement(Oe,{users:d,form:r,formFieldName:Ee.participants,label:"Participants:",onSelectHandler:this.userSelectOnSelect("participant"),onDeselectHandler:this.userSelectOnDeselect("participant")}),!c&&l.a.createElement(Oe,{users:d,form:r,formFieldName:Ee.owners,label:"Participants with owner permissions:",onSelectHandler:this.userSelectOnSelect("owner"),onDeselectHandler:this.userSelectOnDeselect("owner")}),l.a.createElement(ve,{form:r,label:"Check if your playlist is public",fieldName:Ee.isPublic}),l.a.createElement(ve,{form:r,label:"Time restricted",fieldName:Ee.hasTimeRestriction}),s&&l.a.createElement("div",{className:"date-range-picker-container"},l.a.createElement(me.a,Object.assign({showTime:{format:"HH:mm"}},this.getDefaultDateProp(Ee.timeFrom),{getCalendarContainer:function(){return document.getElementById(je)},format:"YYYY-MM-DD HH:mm",placeholder:"Time From",onChange:function(e){var t=e._d.toISOString();r.setFields(Object(R.a)({},Ee.timeFrom,{touched:!0,value:t}))}})),l.a.createElement(me.a,Object.assign({showTime:{format:"HH:mm"}},this.getDefaultDateProp(Ee.timeTo),{getCalendarContainer:function(){return document.getElementById(je)},format:"YYYY-MM-DD HH:mm",placeholder:"Time To",onChange:function(e){var t=e._d.toISOString();r.setFields(Object(R.a)({},Ee.timeTo,{touched:!0,value:t}))}}))),l.a.createElement(ve,{form:r,label:"Location restricted",fieldName:Ee.hasLocationRestriction}),l.a.createElement("div",{className:"location-picker-container".concat(u?"":" hidden")},l.a.createElement(C.a,{containerElement:l.a.createElement("div",{style:{height:"100%"}}),mapElement:l.a.createElement("div",{style:{height:"400px"}}),defaultPosition:this.getDefaultLocation(),onChange:this.handleLocationChange,radius:Number(r.getFieldValue(Ee.locationRadius))||100,zoom:17}),l.a.createElement(pe.a.Item,{label:"Availability radius:"},r.getFieldDecorator(Ee.locationRadius,{validateFirst:!0,rules:[{validator:function(e,t,a){t.toString().length>5?a(!0):a()},message:"Maximum length is 5 symbols."},{pattern:/^\d+$/,message:"Must be a positive integer."},{validator:function(e,t,a){Number(t)<25?a(!0):a()},message:"Must be at least 25 meters."}]})(l.a.createElement(le.a,{placeholder:"Availability radius..."})))),c&&l.a.createElement(o.Fragment,null,l.a.createElement(oe,{playlistId:null,items:t,configureActionColumn:function(){return{title:"Action",key:"action",width:"15%`",className:"ant-actions-column",render:function(t){var a=t.id;return l.a.createElement("div",{className:"actions-container"},l.a.createElement(w.a,{type:"minus-circle",className:"action-icon",onClick:function(){return e.removeTrackFromListById(a)}}))}}}}),l.a.createElement(ue,{renderItems:function(){return l.a.createElement(oe,{playlistId:null,items:n.searchResultTracks,configureActionColumn:function(){return{title:"Action",key:"action",width:"15%`",className:"ant-actions-column",render:function(t){return l.a.createElement("div",{className:"actions-container"},l.a.createElement(w.a,{type:"plus-circle",className:"action-icon",onClick:function(){return e.addTrackToList(t)}}))}}}})},handleSearch:n.searchTracks,searchIsLoading:n.searchAsyncState===Y})),l.a.createElement(T.a,{type:"primary",onClick:this.handleOk},"Submit"))}}]),t}(o.Component),xe=pe.a.create({mapPropsToFields:function(e){var t,a,r,n=e.playListItem,i=Ee.name,c=Ee.participants,s=Ee.owners,o=Ee.hasTimeRestriction,l=Ee.timeFrom,u=Ee.timeTo,d=Ee.isPublic,p=Ee.hasLocationRestriction,m=Ee.locationRadius,h=(t={},Object(R.a)(t,i,"Test Play Lists Name"),Object(R.a)(t,d,!0),Object(R.a)(t,s,[]),Object(R.a)(t,c,[]),Object(R.a)(t,o,!1),Object(R.a)(t,l,null),Object(R.a)(t,u,null),Object(R.a)(t,p,!1),Object(R.a)(t,m,100),t),f=n&&n instanceof Object?Object.assign({},h,n,(a={},Object(R.a)(a,p,Boolean(n.place)),Object(R.a)(a,o,Boolean(n.time_from)||Boolean(n.time_to)),Object(R.a)(a,m,D()(n,["place","radius"],100)),a)):h;return r={},Object(R.a)(r,i,pe.a.createFormField({value:f[i]})),Object(R.a)(r,d,pe.a.createFormField({value:f[d]})),Object(R.a)(r,s,pe.a.createFormField({value:f[s]})),Object(R.a)(r,c,pe.a.createFormField({value:f[c]})),Object(R.a)(r,o,pe.a.createFormField({value:f[o]})),Object(R.a)(r,l,pe.a.createFormField({value:f[l]})),Object(R.a)(r,u,pe.a.createFormField({value:f[u]})),Object(R.a)(r,p,pe.a.createFormField({value:f[p]})),Object(R.a)(r,m,pe.a.createFormField({value:f[m]})),r}})(Object(k.c)(Pe)),Le=Object(k.b)("playlistsStore","tracksStore","settingsStore")(Object(k.c)(xe)),Ne=function(e){function t(){var e,a;Object(p.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(n)))).handleFormSubmit=function(e){var t=a.props,r=t.hideModal;(0,t.handleOk)(e),r()},a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props,t=e.visible,a=e.hideModal,r=e.isCreateForm,n=e.playListItem;return l.a.createElement(de.a,{visible:t,maskClosable:!1,footer:null,onCancel:a,wrapClassName:"avoid-dz-player-modal custom-scroll-bar",width:"80vw"},l.a.createElement("h2",null,r?"New Playlist":"Edit Playlist"),l.a.createElement(Le,{isCreateForm:r,playListItem:n,handleSubmit:this.handleFormSubmit}))}}]),t}(o.Component),Te=(a(480),function(e,t){return t.votes.length-e.votes.length}),Fe={pending:0,fail:-1,success:1},Ce=function(e){function t(){var e,a;Object(p.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(n)))).state={playlistEditModalVisible:!1,locationCheckState:Fe.pending,wrongLocationShowHostLocation:!1},a.prevLocationData=null,a.hostLocation=null,a.serverSocket=null,a.playlistLoadedToPlayer=!1,a.currentTrackPosition=null,a.componentDidMount=Object(x.a)(P.a.mark(function e(){var t;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params.id,window.DZ.Event.subscribe("player_position",a.handleDzPlayerPositionEvent),e.next=4,a.loadPlaylistData(!0);case 4:a.serverSocket=new WebSocket("".concat(V,"/playlist/").concat(t,"/")),a.serverSocket.addEventListener("message",a.handleSocketMessage),a.checkPlaylistGeolocation();case 7:case"end":return e.stop()}},e,this)})),a.componentWillUnmount=function(){window.DZ.Event.unsubscribe("player_position",a.handleDzPlayerPositionEvent),a.serverSocket&&(a.serverSocket.removeEventListener("message",a.handleSocketMessage),a.serverSocket.close())},a.componentDidUpdate=function(e){var t=a.props,r=t.playlistsStore,n=t.match.params.id,i=Object(O.q)(r.getPlayListDataByIdSafe(n));i.place&&(a.prevLocationData?$(i.place,a.prevLocationData)&&a.checkPlaylistGeolocation():a.checkPlaylistGeolocation()),a.prevLocationData=i.place||null},a.handleDzPlayerPositionEvent=function(e){a.currentTrackPosition=e[0]||0},a.loadPlaylistData=Object(x.a)(P.a.mark(function e(){var t,r,n,i,c,s=arguments;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=s.length>0&&void 0!==s[0]&&s[0],r=a.props,n=r.playlistsStore,i=r.history,c=r.match.params.id,e.prev=2,e.next=5,n.loadFullPlayListData(c);case 5:e.next=13;break;case 7:if(e.prev=7,e.t0=e.catch(2),!te(e.t0)){e.next=12;break}return i.push("/playlists"),e.abrupt("return");case 12:t?L.a.error("Error loading playlist data. Please try again later."):console.warn("Error loading playlist data. Please try again later.");case 13:case"end":return e.stop()}},e,this,[[2,7]])})),a.getPlayListData=function(){var e=a.props,t=e.playlistsStore,r=e.match.params.id,n=Number(r);return Object(O.q)(t.getPlayListDataByIdSafe(n))},a.handleDzTrackRemoveFromQueue=function(e,t){var r,n=window.DZ,i=n.player.isPlaying(),c=n.player.getCurrentTrack(),s=t.findIndex(function(e){var t=e.data;return Number(t.id)===Number(c.id)});n.player.pause(),(r=n.player).playTracks.apply(r,[t.map(function(e){return e.data.id})].concat(Object(E.a)(-1!==s?[s,a.currentTrackPosition||0]:[0,0]),[function(){i?n.player.play():n.player.pause()}]))},a.handleSocketMessage=function(){var e=Object(x.a)(P.a.mark(function e(t){var r,n,i,c,s,o,l;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,(r=JSON.parse(D()(t,["data"])||"{}")).message!==_.refresh){e.next=9;break}return n=D()(a.getPlayListData(),"tracks")||[],e.next=6,a.loadPlaylistData();case 6:a.playlistLoadedToPlayer&&(i=D()(a.getPlayListData(),"tracks")||[],c=window,s=c.DZ,i.length>n.length?(o=n.map(function(e){return e.id}),l=i.filter(function(e){var t=e.id;return!o.includes(t)}),s.player.addToQueue(l.map(function(e){return e.data.id}),function(){s.player.changeTrackOrder(i.map(function(e){return e.data.id}))})):i.length<n.length?a.handleDzTrackRemoveFromQueue(n,i):s.player.changeTrackOrder(i.map(function(e){return e.data.id}))),e.next=10;break;case 9:r.message===_.delete&&(a.serverSocket&&a.serverSocket.close(),L.a.info("Playlist was deleted."),a.props.history.push("/playlists"));case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(0),console.warn("Web Socket message processing error.");case 15:case"end":return e.stop()}},e,this,[[0,12]])}));return function(t){return e.apply(this,arguments)}}(),a.checkPlaylistGeolocation=function(){var e=a.props,t=e.playlistsStore,r=e.match.params.id,n=Object(O.q)(t.getPlayListDataByIdSafe(r));a.prevLocationData=n.place,n.place?navigator.geolocation.getCurrentPosition(function(e){var t={lat:e.coords.latitude,lon:e.coords.longitude};a.hostLocation=t;var r=n.place,i=1e3*Q(r,t);a.setState({locationCheckState:i<=n.place.radius?Fe.success:Fe.fail})},function(e){console.warn("Unable to read your geolocation."),a.setState({locationCheckState:Fe.fail})},{enableHighAccuracy:!0}):a.setState({locationCheckState:Fe.success})},a.showEditModal=function(){return a.setState({playlistEditModalVisible:!0})},a.hideEditModal=function(){return a.setState({playlistEditModalVisible:!1})},a.setShowHostLocation=function(e){return a.setState({wrongLocationShowHostLocation:e})},a.handleSubscriptionClick=Object(x.a)(P.a.mark(function e(){var t,r,n,i,c,s,o=arguments;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=o.length>0&&void 0!==o[0]&&o[0],r=a.props,n=r.playlistsStore,i=r.match.params.id,c=Number(i),s=Number(localStorage.getItem(K.userId)),isFinite(s)&&!isNaN(s)){e.next=8;break}return L.a.error("Auth data malformed. Please repeat login."),e.abrupt("return");case 8:if(!t){e.next=19;break}return e.prev=9,e.next=12,n.playlistUnsubscribe(c,s);case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(9),L.a.error("Error proceeding un-subscription.");case 17:e.next=27;break;case 19:return e.prev=19,e.next=22,n.playlistSubscribe(c,s,"add");case 22:e.next=27;break;case 24:e.prev=24,e.t1=e.catch(19),L.a.error("Error proceeding subscription.");case 27:case"end":return e.stop()}},e,this,[[9,14],[19,24]])})),a.handleDeletePlayList=Object(x.a)(P.a.mark(function e(){var t,r,n,i;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props,r=t.playlistsStore,n=t.history,i=t.match.params.id,e.prev=1,e.next=4,r.removePlayListById(Number(i));case 4:n.push("/playlists"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),L.a.error("Can't delete play list.");case 10:case"end":return e.stop()}},e,this,[[1,7]])})),a.handlePlaylistUpdate=function(){var e=Object(x.a)(P.a.mark(function e(t){var r,n,i,c;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props,n=r.playlistsStore,i=r.match.params.id,c=Number(i),a.setShowHostLocation(!1),e.prev=3,e.next=6,n.updatePlayList(Number(c),t);case 6:L.a.success("Playlist updated."),e.next=13;break;case 9:throw e.prev=9,e.t0=e.catch(3),L.a.error("Error updating play list. Please try again later."),e.t0;case 13:case"end":return e.stop()}},e,this,[[3,9]])}));return function(t){return e.apply(this,arguments)}}(),a.addTrackToList=function(){var e=Object(x.a)(P.a.mark(function e(t){var r,n,i,c,s,o;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props,n=r.playlistsStore,i=r.match.params.id,c=Number(i),e.prev=2,e.next=5,n.addTrackToPlaylist(c,Object(O.q)(t.data));case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(2),s=[D()(e.t0,["response","status"]),D()(e.t0,["response","data"])||{}],o=s[1],302===s[0]&&o.detail===H?L.a.warning("Track duplicates are forbidden."):L.a.error("Error adding track to playlist.");case 11:case"end":return e.stop()}},e,this,[[2,7]])}));return function(t){return e.apply(this,arguments)}}(),a.removeTrackById=function(){var e=Object(x.a)(P.a.mark(function e(t){var r,n,i,c;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props,n=r.playlistsStore,i=r.match.params.id,c=Number(i),e.prev=2,e.next=5,n.removeTrackFromPlaylist(c,t);case 5:e.next=10;break;case 7:e.prev=7,e.t0=e.catch(2),L.a.error("Error removing track.");case 10:case"end":return e.stop()}},e,this,[[2,7]])}));return function(t){return e.apply(this,arguments)}}(),a.getWrongLocationProps=function(e){var t=a.state.wrongLocationShowHostLocation,r=e.lat,n=e.lon,i=e.radius;return t?{radius:-1,defaultPosition:{lat:a.hostLocation.lat,lng:a.hostLocation.lon}}:{radius:Number(i)||-1,defaultPosition:{lat:r,lng:n}}},a.renderPlaylistView=function(e,t,r){var n=a.state.locationCheckState,i=a.props,c=i.playlistsStore,s=i.match.params.id,o=r.owner||r.creator;return t&&n===Fe.pending?l.a.createElement(v.a,{spinning:!0},l.a.createElement("div",{className:"play-list-container empty"},"Checking location data...")):t&&n===Fe.fail?l.a.createElement("div",null,l.a.createElement(C.a,Object.assign({containerElement:l.a.createElement("div",{style:{height:"100%"}}),mapElement:l.a.createElement("div",{style:{height:"400px"}})},a.getWrongLocationProps(t),{onChange:function(){},zoom:15})),l.a.createElement("div",{className:"wrong-location-info-block"},l.a.createElement("span",null,"To view this play-list you must be located\xa0"),l.a.createElement("span",{onClick:function(){return a.setShowHostLocation(!1)},className:"link-like"},"HERE"),l.a.createElement("span",null,".\xa0But according to browsers location data you are\xa0"),l.a.createElement("span",{onClick:function(){return a.setShowHostLocation(!0)},className:"link-like"},"HERE"),".")):l.a.createElement("div",{className:"play-list-container"},l.a.createElement(oe,{showRatingColumn:!0,onPlaySideEffect:function(){return a.playlistLoadedToPlayer=!0},playlistId:Number(s),playlistsStore:c,items:e.sort(Te),configureActionColumn:function(){return{title:"Action",key:"action",width:"15%`",className:"ant-actions-column",render:function(e){e.data;var t=e.id;return l.a.createElement("div",{className:"actions-container"},o&&l.a.createElement(N.a,{title:"Are you sure? Track rating will be lost.",okText:"Delete",onConfirm:function(){return a.removeTrackById(t)}},l.a.createElement(w.a,{type:"minus-circle",className:"action-icon"})))}}}}))},a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state.locationCheckState,a=this.props,r=a.playlistsStore,n=a.settingsStore,i=a.tracksStore,c=a.match.params.id,s=Object(O.q)(r.getPlayListDataByIdSafe(c)),o=s.tracks.filter(function(e){var t=e.data;return Boolean(t)}),u=o.map(function(e){return e.data.id}),d=D()(n,["currentUser","id"]),p=s.participants.includes(d)||s.owners.includes(d),m=s.owners.includes(d),h=s.creator===d,f=t===Fe.success,b=p?l.a.createElement(N.a,{title:"Are you sure?".concat(h||m?" You wan't be able to edit this playlist anymore.":""),onConfirm:function(){return e.handleSubscriptionClick(!0)},okText:"Yes"},l.a.createElement(T.a,null,"Unsubscribe")):l.a.createElement(T.a,{onClick:function(){return e.handleSubscriptionClick()}},"Subscribe");return l.a.createElement("div",{className:"content-outer-container dz-player-avoiding-view"},l.a.createElement("div",{className:"playlist-header"},l.a.createElement("h2",null,s.name),f&&l.a.createElement(ne,{className:"dz-play-button-l",trackIds:u,onClickSideEffect:function(){return e.playlistLoadedToPlayer=!0}})),this.renderPlaylistView(o,s.place,{subscribed:p,owner:m,creator:h}),l.a.createElement("div",{className:"play-list-action-buttons-container"},h&&l.a.createElement(N.a,{title:"Are you sure. Deleted playlist can't be restored.",onConfirm:this.handleDeletePlayList,okText:"Delete"},l.a.createElement(T.a,null,"Delete")),(h||m)&&l.a.createElement(T.a,{onClick:this.showEditModal},"Edit"),b),p&&l.a.createElement(ue,{renderItems:function(){return l.a.createElement(oe,{playlistId:null,items:Object(O.q)(i.searchResultTracks),configureActionColumn:function(){return{title:"Action",key:"action",width:"15%`",className:"ant-actions-column",render:function(t){return l.a.createElement("div",{className:"actions-container"},l.a.createElement(w.a,{type:"plus-circle",className:"action-icon",onClick:function(){return e.addTrackToList(t)}}))}}}})},handleSearch:i.searchTracks,searchIsLoading:i.searchAsyncState===Y}),l.a.createElement(Ne,{playListItem:s,visible:this.state.playlistEditModalVisible,hideModal:this.hideEditModal,handleOk:this.handlePlaylistUpdate}))}}]),t}(o.Component),Ie=Object(k.b)("playlistsStore","settingsStore","tracksStore")(Object(k.c)(Ce)),De=pe.a.Item,Me=q,ze=function(e){var t=e.form.getFieldDecorator,a=e.fieldName,r=void 0===a?Me.userName:a,n=e.placeholder,i=void 0===n?"Put user name...":n;return l.a.createElement(De,{label:"User Name"},t(r,{rules:[{required:!0,message:"Field is required."}]})(l.a.createElement(le.a,{placeholder:i})))},Ae=pe.a.Item,Re=q,Ue=function(e){var t=e.form.getFieldDecorator,a=e.fieldName,r=void 0===a?Re.password:a;return l.a.createElement(Ae,{label:"Password"},t(r,{rules:[{required:!0,message:"Password is required."},{min:8,message:"Password must contain at least 8 characters."}]})(l.a.createElement(le.a.Password,{placeholder:"Put password..."})))},Be=pe.a.Item,Ve=q,_e=function(e){var t=e.form.getFieldDecorator,a=e.fieldName,r=void 0===a?Ve.repeatPassword:a;return l.a.createElement(Be,{label:"Repeat Password"},t(r,{rules:[{required:!0,message:"Password is required."},{validator:function(t,a,r){var n=e.form.getFieldValue,i=e.validateToMatchFieldName;return a!==n(void 0===i?Ve.password:i)?r(!0):r()},message:"Password didn't match."}]})(l.a.createElement(le.a.Password,{placeholder:"Repeat password..."})))},He=pe.a.Item,qe=q,We=function(e){var t=e.form.getFieldDecorator,a=e.fieldName,r=void 0===a?qe.email:a;return l.a.createElement(He,{label:"Email"},t(r,{rules:[{required:!0,message:"Email is required."}]})(l.a.createElement(le.a,{placeholder:"Put email..."})))},Ye=(a(482),q),Ze=(r={},Object(R.a)(r,W.register,{headerText:"Registration",formSubmitText:"Register",formActionSwitchText:"Have an Account? Login."}),Object(R.a)(r,W.login,{headerText:"Login",formSubmitText:"Login",formActionSwitchText:"Don't have an Account yet? Register."}),r),Ke=function(e){function t(){var e,a;Object(p.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(n)))).state={showRegisterSuccessMessage:!1},a.formId="authorization-form",a.registeredUserEmail="",a.handleUserRegister=function(){var e=a.props,t=e.form,r=e.settingsStore;t.validateFields(function(){var e=Object(x.a)(P.a.mark(function e(n,i){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=12;break}return e.prev=1,e.next=4,r.userRegister(i);case 4:a.registeredUserEmail=i[Ye.email],a.setState({showRegisterSuccessMessage:!0}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(1),X(t,e.t0),L.a.error("Validation error occurred");case 12:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,a){return e.apply(this,arguments)}}())},a.handleUserLogin=function(){var e=a.props,t=e.form,r=e.settingsStore,n=e.history;t.validateFields(function(){var e=Object(x.a)(P.a.mark(function e(a,i){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=11;break}return e.prev=1,e.next=4,r.userLogin(i);case 4:n.push("/"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),X(t,e.t0),ee(e.t0);case 11:case"end":return e.stop()}},e,this,[[1,7]])}));return function(t,a){return e.apply(this,arguments)}}())},a.handleFormActionSwitch=function(){var e=a.props.form,t=e.getFieldValue,r=e.setFieldsValue,n=W.login,i=W.register,c=t(q.formActionType)===n?i:n;r(Object(R.a)({},q.formActionType,c))},a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state.showRegisterSuccessMessage,a=this.props,r=a.form,n=a.settingsStore,i=r.getFieldDecorator,c=r.getFieldValue;i(Ye.formActionType);var s=c(Ye.formActionType),o=Ze[s]||{},u=o.headerText,d=o.formSubmitText,p=o.formActionSwitchText,m=s===W.register,h=m?this.handleUserRegister:this.handleUserLogin;return t?l.a.createElement("div",{className:"content-outer-container"},l.a.createElement("div",{id:"register-success-info"},l.a.createElement("h2",null,"Registered Successfully"),l.a.createElement("p",null,"Confirmation link is sent to ",l.a.createElement("strong",null,this.registeredUserEmail)),l.a.createElement("div",null,l.a.createElement("span",{className:"link-like",onClick:function(){r.setFieldsValue(Object(R.a)({},Ye.formActionType,W.login)),e.setState({showRegisterSuccessMessage:!1})}},"Go to Login")))):l.a.createElement(v.a,{spinning:n.asyncState===Y},l.a.createElement("div",{className:"content-outer-container"},l.a.createElement("h1",null,u),l.a.createElement(pe.a,{id:this.formId},m&&l.a.createElement(ze,{form:r}),l.a.createElement(We,{form:r}),l.a.createElement(Ue,{form:r}),m&&l.a.createElement(_e,{form:r}),l.a.createElement("div",{className:"text-align-center"},l.a.createElement("span",{className:"link-like",onClick:this.handleFormActionSwitch},p)),l.a.createElement(T.a,{type:"primary",onClick:h},d))))}}]),t}(o.Component),Ge=pe.a.create({mapPropsToFields:function(e){var t;return t={},Object(R.a)(t,Ye.userName,pe.a.createFormField({value:"dmytro-test-login"})),Object(R.a)(t,Ye.password,pe.a.createFormField({value:"abc45678"})),Object(R.a)(t,Ye.repeatPassword,pe.a.createFormField({value:"abc45678"})),Object(R.a)(t,Ye.email,pe.a.createFormField({value:"test@gmail.com"})),Object(R.a)(t,Ye.formActionType,pe.a.createFormField({value:W.login})),t}})(Object(k.c)(Ke)),Je=Object(k.b)("settingsStore")(Object(k.c)(Ge)),Qe={userName:"username",firstName:"first_name",secondName:"last_name",email:"email",newPassword:"new_password1",repeatNewPassword:"new_password2"},$e=[Qe.newPassword,Qe.repeatNewPassword],Xe=[Qe.firstName,Qe.secondName],et=function(e){function t(){var e,a;Object(p.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(n)))).formId="profile-form",a.handleFormConfirm=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=a.props,r=t.form,n=t.settingsStore,i=e?[$e,Xe]:[Xe,$e],c=Object(M.a)(i,2),s=c[0],o=c[1].reduce(function(e,t){return Object(U.a)({},e,Object(R.a)({},t,{value:r.getFieldValue(t),errors:null}))},{});r.validateFields(s,function(){var t=Object(x.a)(P.a.mark(function t(a,i){return P.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a){t.next=19;break}if(t.prev=1,!e){t.next=7;break}return t.next=5,n.changePassword(i);case 5:t.next=9;break;case 7:return t.next=9,n.updateProfile(i);case 9:L.a.success("".concat(e?"Password":"Profile data"," updated successfully.")),t.next=16;break;case 12:t.prev=12,t.t0=t.catch(1),X(r,t.t0),ee(t.t0);case 16:return t.prev=16,r.setFields(o),t.finish(16);case 19:case"end":return t.stop()}},t,this,[[1,12,16,19]])}));return function(e,a){return t.apply(this,arguments)}}())},a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.form,r=t.settingsStore;return l.a.createElement(v.a,{spinning:r.asyncState===Y},l.a.createElement("div",{className:"content-outer-container dz-player-avoiding-view"},l.a.createElement("h1",null,"My Profile"),l.a.createElement(pe.a,{id:this.formId},l.a.createElement(ze,{form:a,fieldName:Qe.firstName,placeholder:"First name..."}),l.a.createElement(ze,{form:a,fieldName:Qe.secondName,placeholder:"Second name..."}),l.a.createElement(T.a,{type:"primary",onClick:function(){return e.handleFormConfirm()}},"Update Profile"),l.a.createElement(Ue,{form:a,fieldName:Qe.newPassword}),l.a.createElement(_e,{form:a,fieldName:Qe.repeatNewPassword,validateToMatchFieldName:Qe.newPassword}),l.a.createElement(T.a,{type:"primary",onClick:function(){return e.handleFormConfirm(!0)}},"Change Password"),l.a.createElement(T.a,{id:"deezer-account-button",type:"primary",onClick:function(){window.DZ.login(function(e){e.authResponse?window.DZ.api("/user/me",function(e){console.log("Good to see you, "+e.name+".")}):console.warn("User cancelled login or did not fully authorize.")},{perms:"basic_access,email"})}},"Connect Deezer Account"))))}}]),t}(o.Component),tt=pe.a.create({mapPropsToFields:function(e){var t,a=e.settingsStore,r=Object(O.q)(a.currentUser);console.log("Map Props To Fields");var n=Qe.firstName,i=Qe.secondName;return t={},Object(R.a)(t,n,pe.a.createFormField({value:r[n]})),Object(R.a)(t,i,pe.a.createFormField({value:r[i]})),Object(R.a)(t,Qe.newPassword,pe.a.createFormField({value:""})),Object(R.a)(t,Qe.repeatNewPassword,pe.a.createFormField({value:""})),t}})(Object(k.c)(et)),at=Object(k.b)("settingsStore")(Object(k.c)(tt)),rt=a(241),nt=a.n(rt),it=[{title:"Id",dataIndex:"id",key:"id",width:"10%"},{title:"Name",dataIndex:"name",key:"name",width:"25%",render:function(e,t){return l.a.createElement("span",null,l.a.createElement(y.b,{to:"/playlists/".concat(t.id)},e))}},{title:"Public",dataIndex:"is_public",key:"is_public",width:"15%`",render:function(e,t){return l.a.createElement("span",null,t.is_public.toString())}},{title:"Restricted",dataIndex:"hasRestrictions",key:"hasRestrictions",width:"10%`",render:function(e,t){var a=[];return t.is_public||a.push("Private"),t.place&&a.push("Location Restricted"),(t.time_from||t.time_to)&&a.push("Time Restricted"),a.length?l.a.createElement("div",{className:"indicators-wrapper"},l.a.createElement(w.a,{type:"check-circle",className:"indicator-icon",title:a.join(" - ")})):null}}],ct={hideOnSinglePage:!0,showSizeChanger:!0},st=function(e){function t(){var e,a;Object(p.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(n)))).state={searchText:""},a.getColumnSearchProps=function(e){return{filterDropdown:function(t){var r=t.setSelectedKeys,n=t.selectedKeys,i=t.confirm,c=t.clearFilters;return l.a.createElement("div",{style:{padding:8}},l.a.createElement(le.a,{ref:function(e){a.searchInput=e},placeholder:"Search ".concat(e),value:n[0],onChange:function(e){return r(e.target.value?[e.target.value]:[])},onPressEnter:function(){return a.handleSearch(n,i)},style:{width:188,marginBottom:8,display:"block"}}),l.a.createElement(T.a,{type:"primary",onClick:function(){return a.handleSearch(n,i)},icon:"search",size:"small",style:{width:90,marginRight:8}},"Search"),l.a.createElement(T.a,{onClick:function(){return a.handleReset(c)},size:"small",style:{width:90}},"Reset"))},filterIcon:function(e){return l.a.createElement(w.a,{type:"search",style:{color:e?"#1890ff":void 0}})},onFilter:function(t,a){return a[e].toString().toLowerCase().includes(t.toLowerCase())},onFilterDropdownVisibleChange:function(e){e&&setTimeout(function(){return a.searchInput.select()})},render:function(e,t){return l.a.createElement(y.b,{to:"/playlists/".concat(t.id)},l.a.createElement(nt.a,{highlightStyle:{backgroundColor:"#ffc069",padding:0},searchWords:[a.state.searchText],autoEscape:!0,textToHighlight:e.toString()}))}}},a.handleSearch=function(e,t){t(),a.setState({searchText:e[0]})},a.handleReset=function(e){e(),a.setState({searchText:""})},a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.playlists;return Object.assign(it[1],Object(U.a)({},this.getColumnSearchProps("name"))),l.a.createElement(A.a,{rowKey:function(e){return"album-item-".concat(e.id)},columns:it,dataSource:e,rowClassName:"album-record",pagination:ct})}}]),t}(o.PureComponent),ot=(a(489),function(e){function t(){var e,a;Object(p.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(n)))).state={newPlayListModalVisible:!1},a.serverSocket=null,a.componentDidMount=Object(x.a)(P.a.mark(function e(){var t,r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.playlistsStore,r=G(),a.serverSocket=new WebSocket("".concat(V,"/user/").concat(r,"/")),a.serverSocket.addEventListener("message",a.handleSocketMessage),e.prev=4,e.next=7,t.getPlayLists();case 7:return e.next=9,t.getMyPlaylists();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(4),L.a.error("Error loading playlists. Please try again later.");case 14:case"end":return e.stop()}},e,this,[[4,11]])})),a.componentWillUnmount=function(){a.serverSocket&&a.serverSocket.close()},a.handleSocketMessage=function(){var e=Object(x.a)(P.a.mark(function e(t){var r,n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.props.playlistsStore,e.prev=1,(n=JSON.parse(D()(t,["data"])||"{}")).message!==_.refresh){e.next=9;break}return console.log("Refresh Playlists"),e.next=7,r.getMyPlaylists();case 7:e.next=10;break;case 9:n.message===_.delete&&console.warn("I don't know what to do on 'delete' message");case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),console.warn("Web Socket message processing error.");case 15:case"end":return e.stop()}},e,this,[[1,12]])}));return function(t){return e.apply(this,arguments)}}(),a.hidePlayListModalForm=function(){return a.setState({newPlayListModalVisible:!1})},a.handleCreatePlayList=function(){var e=Object(x.a)(P.a.mark(function e(t){var r,n,i,c,s;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props,n=r.playlistsStore,i=r.tracksStore,c=Object(E.a)(t.tracks),delete t.tracks,e.prev=3,e.next=6,n.createPlayList(t);case 6:(s=e.sent)&&i.bulkAddTracksToPlaylist(s.id,c),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),L.a.error("Error creating play list. Try again later.");case 13:case"end":return e.stop()}},e,this,[[3,10]])}));return function(t){return e.apply(this,arguments)}}(),a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.playlistsStore,r=t.myPlaylists,n=t.history,i=this.state.newPlayListModalVisible,c=r?Object(O.q)(a.myPlaylists):Object(O.q)(a.playlists);return l.a.createElement("div",{className:"content-outer-container"},l.a.createElement(v.a,{spinning:a.asyncState===Y},l.a.createElement("div",{className:"playlists-header"},l.a.createElement("h2",{className:"page-header"},r?"My Playlists":"Playlists"),l.a.createElement("span",{className:"link-like",onClick:function(){return n.push(r?"/playlists":"/playlists/my")}},"".concat(r?"All playlists":"My playlists"))),l.a.createElement(st,{playlists:c}),l.a.createElement(T.a,{id:"add-new-playlist",type:"primary",onClick:function(){return e.setState({newPlayListModalVisible:!0})}},"Add New Playlist"),l.a.createElement(Ne,{isCreateForm:!0,visible:i,hideModal:this.hidePlayListModalForm,handleOk:this.handleCreatePlayList})))}}]),t}(o.Component)),lt=Object(k.b)("playlistsStore","tracksStore")(Object(k.c)(ot)),ut=pe.a.Item,dt=function(e){function t(){return Object(p.a)(this,t),Object(h.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.props.playlistsStore;return l.a.createElement("div",{className:"content-outer-container"},l.a.createElement(v.a,{spinning:e.asyncState===Y},l.a.createElement(pe.a,null,l.a.createElement(ut,{label:"Play List Title"},l.a.createElement(le.a,null)),l.a.createElement(ut,{label:"Keywords"},l.a.createElement(ge.a,null)))))}}]),t}(o.Component),pt=Object(k.b)("playlistsStore")(Object(k.c)(dt)),mt=function(e){return re()?l.a.createElement(at,e):l.a.createElement(j.a,{to:"/auth"})},ht=function(e){return re()?l.a.createElement(lt,e):l.a.createElement(j.a,{to:"/auth"})},ft=function(e){return re()?l.a.createElement(lt,Object.assign({myPlaylists:!0},e)):l.a.createElement(j.a,{to:"/auth"})},bt=function(e){return l.a.createElement(Je,e)},yt=function(e){return re()?l.a.createElement(Ie,e):l.a.createElement(j.a,{to:"/auth"})},vt=function(e){return re()?l.a.createElement(pt,e):l.a.createElement(j.a,{to:"/auth"})},gt=Object(j.f)(function(e){e.history;return l.a.createElement(j.d,null,l.a.createElement(j.b,{exact:!0,path:"/",render:function(){return l.a.createElement(j.a,{to:"/playlists"})}}),l.a.createElement(j.b,{exact:!0,path:"/main",render:function(){return l.a.createElement(j.a,{to:"/playlists"})}}),l.a.createElement(j.b,{exact:!0,path:"/profile",render:mt}),l.a.createElement(j.b,{exact:!0,path:"/playlists",render:ht}),l.a.createElement(j.b,{exact:!0,path:"/playlists/my",render:ft}),l.a.createElement(j.b,{exact:!0,path:"/auth",render:bt}),l.a.createElement(j.b,{exact:!0,path:"/playlists/:id",render:yt}),l.a.createElement(j.b,{exact:!0,path:"/playlists/:id/edit",render:vt}))}),wt=a(16),kt=a(17),Ot=(a(118),new(n=Object(O.d)("set items using value"),i=function e(){Object(p.a)(this,e),Object(wt.a)(this,"items",c,this),Object(wt.a)(this,"setItems",s,this)},c=Object(kt.a)(i.prototype,"items",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),s=Object(kt.a)(i.prototype,"setItems",[n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){var t=Object(x.a)(P.a.mark(function t(a){return P.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:Object(O.n)("setting items",function(){e.items=a});case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}}),i)),jt=a(243),Et=new(a.n(jt).a.create)({baseURL:"https://musicroom.ml/",timeout:3e3,headers:{}}),St=["auth/registration/","auth/login/"];Et.interceptors.request.use(function(e){var t=localStorage.getItem(K.token),a=e.url;return St.includes(a)||t&&Object.assign(e.headers.common,{Authorization:"JWT ".concat(t)}),e},function(e){return Promise.reject(e)});var Pt,xt,Lt,Nt,Tt,Ft,Ct,It,Dt,Mt,zt,At,Rt,Ut,Bt,Vt,_t,Ht,qt,Wt,Yt,Zt,Kt,Gt,Jt,Qt,$t,Xt,ea,ta,aa,ra,na,ia,ca,sa,oa,la,ua,da,pa,ma,ha,fa,ba,ya,va,ga,wa,ka,Oa,ja,Ea,Sa,Pa,xa,La,Na,Ta,Fa=function(e){return Et.post("auth/registration/",e)},Ca=function(e){return Et.post("auth/login/",e)},Ia=function(e){return Et.post("auth/password/change/",e)},Da=function(){return Et.get("api/playlists/")},Ma=function(e){return Et.get("api/users/".concat(e,"/playlists/"))},za=function(e){return Et.get("api/playlists/".concat(e,"/"))},Aa=function(e){return Et.post("api/playlists/",e)},Ra=function(e,t){return Et.patch("api/playlists/".concat(e,"/"),t)},Ua=function(e){return Et.delete("api/playlists/".concat(e,"/"))},Ba=function(e,t){return Et.patch("/api/playlists/".concat(e,"/owners/").concat(t,"/"))},Va=function(e,t){return Et.delete("/api/playlists/".concat(e,"/owners/").concat(t,"/"))},_a=function(e,t){return Et.patch("/api/playlists/".concat(e,"/participants/").concat(t,"/"))},Ha=function(e,t){return Et.delete("/api/playlists/".concat(e,"/participants/").concat(t,"/"))},qa=function(e,t){return Et.delete("/api/playlists/".concat(e,"/users/").concat(t,"/"))},Wa=function(e){return Et.post("api/votes/".concat(e,"/"))},Ya=function(e,t){return Et.post("api/tracks/",{playlist:e,data:t})},Za=function(e){return Et.delete("api/tracks/".concat(e,"/"))},Ka=function(){return Et.get("api/users/")},Ga=function(e){return Et.get("api/users/".concat(e,"/"))},Ja=function(e,t){return Et.patch("api/users/".concat(e,"/"),t)},Qa=q,$a=new(Pt=Object(O.d)("user register"),xt=Object(O.d)("user login"),Lt=Object(O.d)("user logout"),Nt=Object(O.d)("get my user"),Tt=Object(O.d)("update profile"),Ft=Object(O.d)("change password"),Ct=Object(O.d)("get users"),It=function e(){Object(p.a)(this,e),Object(wt.a)(this,"asyncState",Dt,this),Object(wt.a)(this,"currentUser",Mt,this),Object(wt.a)(this,"allUsers",zt,this),this.parseRegisterBody=function(e){return{username:e[Qa.userName],password1:e[Qa.password],password2:e[Qa.repeatPassword],email:e[Qa.email]}},Object(wt.a)(this,"userRegister",At,this),this.parseLoginBody=function(e){return{email:e[Qa.email],password:e[Qa.password]}},Object(wt.a)(this,"userLogin",Rt,this),Object(wt.a)(this,"userLogout",Ut,this),Object(wt.a)(this,"getMyUser",Bt,this),Object(wt.a)(this,"updateProfile",Vt,this),Object(wt.a)(this,"changePassword",_t,this),Object(wt.a)(this,"getUsers",Ht,this)},Dt=Object(kt.a)(It.prototype,"asyncState",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Z}}),Mt=Object(kt.a)(It.prototype,"currentUser",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{id:Number(localStorage.getItem(K.userId))}}}),zt=Object(kt.a)(It.prototype,"allUsers",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),At=Object(kt.a)(It.prototype,"userRegister",[Pt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t){var a;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.asyncState=Y,a=this.parseRegisterBody(t),e.next=5,Fa(a);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(0),e.t0;case 10:return e.prev=10,this.asyncState=Z,e.finish(10);case 13:case"end":return e.stop()}},e,this,[[0,7,10,13]])}).bind(this))}}),Rt=Object(kt.a)(It.prototype,"userLogin",[xt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t){var a,r,n,i;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,e.prev=1,a=this.parseLoginBody(t),e.next=5,Ca(a);case 5:r=e.sent,n=r.data,i=n.user,Object.assign(i,{id:i.pk}),delete i.pk,this.currentUser=i,n.token&&(localStorage.setItem(K.userId,i.id),localStorage.setItem(K.token,n.token)),e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(1),e.t0;case 17:return e.prev=17,this.asyncState=Z,e.finish(17);case 20:case"end":return e.stop()}},e,this,[[1,14,17,20]])}).bind(this))}}),Ut=Object(kt.a)(It.prototype,"userLogout",[Lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.currentUser={},localStorage.removeItem(K.userId),localStorage.removeItem(K.token)}}}),Bt=Object(kt.a)(It.prototype,"getMyUser",[Nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(){var t,a,r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,this.asyncState=Y,!(t=G())){e.next=9;break}return e.next=6,Ga(t);case 6:a=e.sent,r=a.data,this.currentUser=r;case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(0),e.t0;case 14:return e.prev=14,this.asyncState=Z,e.finish(14);case 17:case"end":return e.stop()}},e,this,[[0,11,14,17]])}).bind(this))}}),Vt=Object(kt.a)(It.prototype,"updateProfile",[Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t){var a,r,n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.asyncState=Y,a=G(),e.next=5,Ja(a,t);case 5:r=e.sent,n=r.data,this.currentUser=n,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(0),e.t0;case 13:return e.prev=13,this.asyncState=Z,e.finish(13);case 16:case"end":return e.stop()}},e,this,[[0,10,13,16]])}).bind(this))}}),_t=Object(kt.a)(It.prototype,"changePassword",[Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.asyncState=Y,e.next=4,Ia(t);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:return e.prev=9,this.asyncState=Z,e.finish(9);case 12:case"end":return e.stop()}},e,this,[[0,6,9,12]])}).bind(this))}}),Ht=Object(kt.a)(It.prototype,"getUsers",[Ct],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(){var t,a;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,e.prev=1,e.next=4,Ka();case 4:t=e.sent,a=t.data,this.allUsers=a,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(1),e.t0;case 12:return e.prev=12,this.asyncState=Z,e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}).bind(this))}}),It),Xa=function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return new Promise(function(e,a){var r;(r=window.DZ).api.apply(r,t.concat([function(t){t.error&&a(t.error),e(t)}]))})},er=function(e){var t=Object.entries(e).reduce(function(e,t){var a=Object(M.a)(t,2),r=a[0],n=a[1];return e+"".concat(r,':"').concat(n,'" ')},"");return Xa("search?q="+t)},tr=new(qt=Object(O.d)("search for tracks"),Wt=Object(O.d)("add tracks to playlist by id"),Yt=Object(O.d)("bulk add tracks to playlist"),Zt=function e(){Object(p.a)(this,e),Object(wt.a)(this,"asyncState",Kt,this),Object(wt.a)(this,"searchAsyncState",Gt,this),Object(wt.a)(this,"searchResultTracks",Jt,this),Object(wt.a)(this,"playlistsTracks",Qt,this),Object(wt.a)(this,"searchTracks",$t,this),Object(wt.a)(this,"addTrackToPlaylist",Xt,this),Object(wt.a)(this,"bulkAddTracksToPlaylist",ea,this)},Kt=Object(kt.a)(Zt.prototype,"asyncState",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Z}}),Gt=Object(kt.a)(Zt.prototype,"searchAsyncState",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Z}}),Jt=Object(kt.a)(Zt.prototype,"searchResultTracks",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Qt=Object(kt.a)(Zt.prototype,"playlistsTracks",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),$t=Object(kt.a)(Zt.prototype,"searchTracks",[qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t){var a;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.searchAsyncState=Y,e.prev=1,e.next=4,er(t);case 4:a=e.sent,this.searchResultTracks=a.data.map(function(e){return{id:e.id,data:e}}),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(1),e.t0;case 11:return e.prev=11,this.searchAsyncState=Z,e.finish(11);case 14:case"end":return e.stop()}},e,this,[[1,8,11,14]])}).bind(this))}}),Xt=Object(kt.a)(Zt.prototype,"addTrackToPlaylist",[Wt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t,a){var r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,e.prev=1,e.next=4,Ya(t,a);case 4:(r=e.sent)&&this.playlistsTracks[t].push(r),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(1),e.t0;case 11:return e.prev=11,this.asyncState=Z,e.finish(11);case 14:case"end":return e.stop()}},e,this,[[1,8,11,14]])})).bind(this)}}),ea=Object(kt.a)(Zt.prototype,"bulkAddTracksToPlaylist",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t,a){var r,n,i,c,s,o;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.asyncState=Y,r=!0,n=!1,i=void 0,e.prev=4,c=a[Symbol.iterator]();case 6:if(r=(s=c.next()).done){e.next=18;break}return o=s.value,e.prev=8,e.next=11,Ya(t,o);case 11:e.next=15;break;case 13:e.prev=13,e.t0=e.catch(8);case 15:r=!0,e.next=6;break;case 18:e.next=24;break;case 20:e.prev=20,e.t1=e.catch(4),n=!0,i=e.t1;case 24:e.prev=24,e.prev=25,r||null==c.return||c.return();case 27:if(e.prev=27,!n){e.next=30;break}throw i;case 30:return e.finish(27);case 31:return e.finish(24);case 32:this.asyncState=Z;case 33:case"end":return e.stop()}},e,this,[[4,20,24,32],[8,13],[25,,27,31]])})).bind(this)}}),Zt),ar={tracks:[],participants:[],owners:[]},rr=new(ta=Object(O.d)("get play lists"),aa=Object(O.d)("get play lists"),ra=Object(O.d)("create playlist"),na=Object(O.d)("update playlist"),ia=Object(O.d)("remove playlist"),ca=Object(O.d)("get playlist tracks"),sa=Object(O.d)("add playlist owner"),oa=Object(O.d)("add playlist owner"),la=Object(O.d)("add playlist owner"),ua=Object(O.d)("add tracks to playlist data"),da=Object(O.d)("remove track from playlist"),pa=Object(O.d)("vote track"),ma=function e(){var t=this;Object(p.a)(this,e),Object(wt.a)(this,"asyncState",ha,this),Object(wt.a)(this,"searchAsyncState",fa,this),Object(wt.a)(this,"playlists",ba,this),Object(wt.a)(this,"myPlaylists",ya,this),Object(wt.a)(this,"fullPlayListData",va,this),Object(wt.a)(this,"getPlayLists",ga,this),Object(wt.a)(this,"getMyPlaylists",wa,this),Object(wt.a)(this,"createPlayList",ka,this),Object(wt.a)(this,"updatePlayList",Oa,this),Object(wt.a)(this,"removePlayListById",ja,this),this.getPlayListDataByIdSafe=function(e){return t.fullPlayListData[e]||ar},this.getPlayListDataById=function(e){return t.fullPlayListData[e]},this.getPlayListById=function(e){return t.playlists.find(function(t){var a=t.id;return e===a})},this.getMyPlayListById=function(e){return t.myPlaylists.find(function(t){var a=t.id;return e===a})},this.getPlayListTrackById=function(e,t){return e.tracks.find(function(e){return e.id===t})},Object(wt.a)(this,"loadFullPlayListData",Ea,this),Object(wt.a)(this,"playlistOwner",Sa,this),Object(wt.a)(this,"playlistParticipant",Pa,this),this.playlistSubscribe=this.playlistParticipant,Object(wt.a)(this,"playlistUnsubscribe",xa,this),Object(wt.a)(this,"addTrackToPlaylist",La,this),Object(wt.a)(this,"removeTrackFromPlaylist",Na,this),Object(wt.a)(this,"voteTrack",Ta,this)},ha=Object(kt.a)(ma.prototype,"asyncState",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Z}}),fa=Object(kt.a)(ma.prototype,"searchAsyncState",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Z}}),ba=Object(kt.a)(ma.prototype,"playlists",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ya=Object(kt.a)(ma.prototype,"myPlaylists",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),va=Object(kt.a)(ma.prototype,"fullPlayListData",[O.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return{}}}),ga=Object(kt.a)(ma.prototype,"getPlayLists",[ta],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(){var t,a;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,e.prev=1,e.next=4,Da();case 4:t=e.sent,a=t.data,this.playlists=a,e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(1),e.t0;case 12:return e.prev=12,this.asyncState=Z,e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,9,12,15]])}).bind(this))}}),wa=Object(kt.a)(ma.prototype,"getMyPlaylists",[aa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(){var t,a,r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,e.prev=1,t=G(),e.next=5,Ma(t);case 5:a=e.sent,r=a.data,this.myPlaylists=r,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(1),e.t0;case 13:return e.prev=13,this.asyncState=Z,e.finish(13);case 16:case"end":return e.stop()}},e,this,[[1,10,13,16]])}).bind(this))}}),ka=Object(kt.a)(ma.prototype,"createPlayList",[ra],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t){var a,r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,e.prev=1,e.next=4,Aa(t);case 4:return a=e.sent,r=a.data,this.playlists=Object(E.a)(this.playlists).concat([r]),this.myPlaylists=Object(E.a)(this.myPlaylists).concat([r]),e.abrupt("return",r);case 11:throw e.prev=11,e.t0=e.catch(1),e.t0;case 14:return e.prev=14,this.asyncState=Z,e.finish(14);case 17:case"end":return e.stop()}},e,this,[[1,11,14,17]])}).bind(this))}}),Oa=Object(kt.a)(ma.prototype,"updatePlayList",[na],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t,a){var r,n,i,c;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,e.prev=1,e.next=4,Ra(t,a);case 4:r=e.sent,n=r.data,i=this.getPlayListById(t),c=this.getMyPlayListById(t),i&&Object(O.o)(i,n),c&&Object(O.o)(c,n),this.fullPlayListData[t]&&Object(O.o)(this.fullPlayListData[t],n),e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(1),e.t0;case 16:return e.prev=16,this.asyncState=Z,e.finish(16);case 19:case"end":return e.stop()}},e,this,[[1,13,16,19]])}).bind(this))}}),ja=Object(kt.a)(ma.prototype,"removePlayListById",[ia],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,e.prev=1,e.next=4,Ua(t);case 4:this.playlists=this.playlists.filter(function(e){return e.id!==t}),this.myPlaylists=this.myPlaylists.filter(function(e){return e.id!==t}),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(1),e.t0;case 11:return e.prev=11,this.asyncState=Z,e.finish(11);case 14:case"end":return e.stop()}},e,this,[[1,8,11,14]])}).bind(this))}}),Ea=Object(kt.a)(ma.prototype,"loadFullPlayListData",[ca],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t){var a,r,n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,a=this.fullPlayListData[t],e.prev=2,e.next=5,za(t);case 5:r=e.sent,n=r.data,a?Object(O.o)(this.fullPlayListData,t,n||ar):Object(O.g)(this.fullPlayListData,Object(R.a)({},t,n||ar)),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(2),e.t0;case 13:return e.prev=13,this.asyncState=Z,e.finish(13);case 16:case"end":return e.stop()}},e,this,[[2,10,13,16]])}).bind(this))}}),Sa=Object(kt.a)(ma.prototype,"playlistOwner",[sa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t,a,r){var n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.asyncState=Y,e.prev=1,n=this.getPlayListDataById(t),"add"!==r){e.next=9;break}return e.next=6,Ba(t,a);case 6:n&&Object(O.o)(n,{owners:Object(E.a)(n.owners).concat([a])}),e.next=13;break;case 9:if("remove"!==r){e.next=13;break}return e.next=12,Va(t,a);case 12:n&&Object(O.o)(n,{owners:n.owners.filter(function(e){return e!==a})});case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(1),e.t0;case 18:return e.prev=18,this.asyncState=Z,e.finish(18);case 21:case"end":return e.stop()}},e,this,[[1,15,18,21]])}).bind(this))}}),Pa=Object(kt.a)(ma.prototype,"playlistParticipant",[oa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t,a,r){var n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.asyncState=Y,e.prev=1,n=this.getPlayListDataById(t),"add"!==r){e.next=9;break}return e.next=6,_a(t,a);case 6:n&&Object(O.o)(n,{participants:Object(E.a)(n.participants).concat([a])}),e.next=13;break;case 9:if("remove"!==r){e.next=13;break}return e.next=12,Ha(t,a);case 12:n&&Object(O.o)(n,{participants:n.participants.filter(function(e){return e!==a})});case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(1),e.t0;case 18:return e.prev=18,this.asyncState=Z,e.finish(18);case 21:case"end":return e.stop()}},e,this,[[1,15,18,21]])}).bind(this))}}),xa=Object(kt.a)(ma.prototype,"playlistUnsubscribe",[la],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t,a){var r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,e.prev=1,r=this.getPlayListDataById(t),e.next=5,qa(t,a);case 5:r&&Object(O.o)(r,{participants:r.participants.filter(function(e){return e!==a}),owners:r.owners.filter(function(e){return e!==a})}),e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(1),e.t0;case 11:return e.prev=11,this.asyncState=Z,e.finish(11);case 14:case"end":return e.stop()}},e,this,[[1,8,11,14]])}).bind(this))}}),La=Object(kt.a)(ma.prototype,"addTrackToPlaylist",[ua],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t,a){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,e.prev=1,e.next=4,Ya(t,a);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),e.t0;case 9:return e.prev=9,this.asyncState=Z,e.finish(9);case 12:case"end":return e.stop()}},e,this,[[1,6,9,12]])})).bind(this)}}),Na=Object(kt.a)(ma.prototype,"removeTrackFromPlaylist",[da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t,a){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.asyncState=Y,e.prev=1,e.next=4,Za(a);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),e.t0;case 9:return e.prev=9,this.asyncState=Z,e.finish(9);case 12:case"end":return e.stop()}},e,this,[[1,6,9,12]])})).bind(this)}}),Ta=Object(kt.a)(ma.prototype,"voteTrack",[pa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Object(O.h)(P.a.mark(function e(t,a){var r,n,i,c,s,o,l=arguments;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],this.asyncState=Y,e.prev=2,e.next=5,Wa(t);case 5:n=e.sent,i=n.data,c=G(),(s=this.getPlayListDataById(a))&&(o=this.getPlayListTrackById(s,t))?!r&&i?Object(O.o)(o,{votes:Object(E.a)(o.votes).concat([i])}):Object(O.o)(o,{votes:o.votes.filter(function(e){var t=e.user;return Number(t)!==c})}):console.warn("voteTrack :: no playlist data"),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(2),e.t0;case 15:return e.prev=15,this.asyncState=Z,e.finish(15);case 18:case"end":return e.stop()}},e,this,[[2,12,15,18]])})).bind(this)}}),ma),nr=(a(509),[{title:"User profile",link:"/profile",icon:"message"},{title:"Playlists",link:"/playlists",icon:"link"},{title:"Authorization",link:"/auth",icon:"check"}]),ir=function(e){function t(){var e,a;Object(p.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(n)))).state={menuOpened:!1},a.toggleMenuOpened=function(){a.setState(function(e){return{menuOpened:!e.menuOpened}})},a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this,t=this.state.menuOpened,a=this.props,r=a.settingsStore,n=a.history,i=t?{type:"menu-fold",menuClassName:""}:{type:"menu-unfold",menuClassName:" collapsed"};return l.a.createElement("div",{id:"app-header"},l.a.createElement("ul",{className:"ant-menu ant-menu-dark ant-menu-root ant-menu-inline".concat(i.menuClassName)},l.a.createElement(w.a,{type:i.type,className:"main-menu-icon",onClick:this.toggleMenuOpened}),nr.map(function(t){var a=t.title,r=t.link,n=t.icon;return l.a.createElement("li",{key:a,onClick:e.toggleMenuOpened},l.a.createElement(y.c,{to:r,className:"ant-menu-item",activeClassName:"ant-menu-item-selected",onContextMenu:function(e){return e.preventDefault()},strict:!0},l.a.createElement(w.a,{type:n}),l.a.createElement("span",null,a)))})),l.a.createElement("h2",null,"Music Room"),re()&&l.a.createElement("div",{className:"app-header-logout-panel"},"Hello, ",l.a.createElement("strong",null,r.currentUser.username),l.a.createElement("span",{className:"link-like",onClick:function(){r.userLogout(),n.push("/auth")}},"Logout")))}}]),t}(o.Component),cr=Object(k.b)("settingsStore")(Object(k.c)(Object(j.f)(ir)));a(511),a(513);Object(O.e)({enforceActions:"always"});var sr=!1,or=sr?"":"/",lr=function(e){function t(){var e,a;Object(p.a)(this,t);for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return(a=Object(h.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(n)))).state={globalInitiallyLoading:!0,playerExpanded:!1,hasError:!1},a.componentDidMount=function(){try{$a.getMyUser().catch(function(){return a.setState({hasError:!0})}).finally(function(){return a.setState({globalInitiallyLoading:!1})})}catch(e){console.error("Error caught in App.componentDidMount")}},a.componentDidUpdate=function(e,t){!t.globalInitiallyLoading||a.state.globalInitiallyLoading||a.state.hasError||void 0!==window.DZ&&(console.log("Deezer SDK is loaded"),window.DZ.init({appId:"336362",channelUrl:sr?"http://localhost:3000/channel.html":"https://front.musicroom.ml/channel.html",player:{container:"dz-player",width:800,height:300,playlist:!0,onload:function(){console.log("Player is loaded")}}}))},a.togglePlayerExpanded=function(){a.setState(function(e){return{playerExpanded:!e.playerExpanded}})},a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"render",value:function(){var e=this.state,t=e.playerExpanded,a=e.globalInitiallyLoading,r=e.hasError;return a?l.a.createElement(v.a,{spinning:!0},l.a.createElement("div",{id:"the-great-loader"})):r?l.a.createElement("div",{id:"the-great-error"},l.a.createElement("p",null,"Error occurred"),l.a.createElement("p",null,"Please clean the ",l.a.createElement("strong",null,l.a.createElement("i",null,"localStorage"))),l.a.createElement("p",null,"and reload application.")):l.a.createElement(k.a,{sandboxStore:Ot,settingsStore:$a,tracksStore:tr,playlistsStore:rr},l.a.createElement(y.a,{basename:or},l.a.createElement(g.a,null,l.a.createElement(cr,null),l.a.createElement(g.a,{className:"main-content-wrapper"},l.a.createElement(gt,null)),l.a.createElement("div",{id:"dz-player-container",className:t?"expanded":""},l.a.createElement("span",{id:"dz-player-anchor",onClick:this.togglePlayerExpanded},l.a.createElement(w.a,{type:t?"caret-down":"caret-up"})),l.a.createElement("div",{id:"dz-player"})))))}}]),t}(o.Component),ur=Object(k.c)(lr);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(515);d.a.render(l.a.createElement(ur,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[245,2,1]]]);
//# sourceMappingURL=main.8ca1dedb.chunk.js.map